<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
	<head th:replace="~{/layout/fragments :: htmlHead('insert title')}"></head>
	
	<style>
	
	.novelList{
		display: flex;
		width: 100%;
		flex-direction: column;
		padding: 0 30px;
	}
	
	.my-novel{
	    background: white;
	    display: flex; /* grid에서 flex로 변경 */
	    flex-direction: row; /* 가로 정렬 유지 */
	    align-items: center;
	    justify-content: space-evenly;
	    width: 100%; /* 한 줄에 하나씩 */
	    padding: 10px;
	}
	
	.novelContent {
		width: 800px;
	
	}
	
	img.coverImg{
		height:180px;
	}
	
	.novelWriter{
		display: flex;
		flex-direction: row;
		flex-wrap: wrap;
		justify-content: space-evenly;
		margin-top : 20px;
		padding: 5px;
	}
	
	div.container{
		background: white;
		height: 100%;
		display: flex;
		flex-direction: row;
		flex-wrap: wrap;
		justify-content: space-evenly;
		margin-top: 20px;
	}
	
	
	.nav-work {
		background: white;
		height:80px;	
		width: 160px;
		float:left;
		border: 1px solid gray;
		border-radius: 12px;
		display: flex;
		justify-content: center;
		align-items: center;
		margin-left: 10px;
		
	}
	.nav-link{
		text-align: center;
	}
	
	.gradeIcon span{
		border: 1px solid white;
		background: #cf97ff;
		color : white;
		padding: 2px;
		border-radius: 12px;
	}
	
	
	</style>
	
	<body>
		<th:block th:replace="~{/layout/fragments :: pageHeader}"></th:block>
		<main>
		    <div class="container ">
		        <ul>
		            <li class="nav-work">
		                <a class="nav-link active" th:href="@{/novel/my-works(id=${#authentication.principal.id})}">내 작품</a>
		            </li>
		            <li class="nav-work">
		                <a class="nav-link" th:href="@{/novel/my-works/donation}">후원관리</a>
		            </li>
		            <li class="nav-work">
		                <a class="nav-link" th:href="@{/novel/my-works/stats}">통계</a>
		            </li>
		            <li class="nav-work">
		                <a class="nav-link" th:href="@{/novel/my-works/withdraw}">정산</a>
		            </li>
		        </ul>    
		    </div>
		    
		    <div class="novelWriter">
				<a class="btn btn-success form-control" th:href="@{/novel/new}">작품작성</a>	    	
		    </div>
			
			<hr/>
			<div class="novelList">
				<div th:each="novel : ${novels}" th:object="${novel}">
					<div class="my-novel" >
						<div class="novelCoverImg">
							<img class="coverImg" th:src="@{{novel.coverSrc}(novel.coverSrc=${novel.coverSrc})}">
						</div>
						<div class="novelContent">
							<div class="gradeIcon">
								<span th:text="*{grade == 0 ? '무료' : '유료'}"></span>
							</div>
							<a th:href="@{/novel/{id}(id=*{id})}">
								<b th:text="*{title}"></b>
							</a>
							
							<span th:text="*{writer}"></span>
							<br/>
							
							<span th:text="*{intro}"></span>
							
							<br/>
							<span>
								<i class="bi bi-heart"></i>
								<span th:text="${novel.likeCount}"></span>
								<i class="bi bi-star"></i>
								<span th:text="${#numbers.formatDecimal(novel.rating, 1, 1)} ?: '0.0'">0.0</span>
							</span>
							<br/>
							<!-- 장르 -->
							<span th:each="genre : ${novel.genres}">
								<span th:text="|웹소설-${genre}|"></span>
							</span>
						</div>
						<div class="novelModifyBtn">
			                <a class="btn btn-secondary " th:href="@{/novel/modify/{id}(id=${novel.id})}">작품수정</a>
			                <br/>
			                <a class="btn btn-secondary mt-2" th:href="@{/novel/{id}/episode/create(id=${novel.id})}">회차작성</a><!-- 추가 -->
			                <br/>
			                <button class="btn btn-secondary mt-2" th:onclick="'location.href=\'/novel/premium/' + ${novel.id} + '\''"
			                 th:data-novel-id="${novel.id}"
			                 th:disabled="${premiumStatus[novel.id] == '대기중' or premiumStatus[novel.id] == '완료'}"
			                 th:text="${premiumStatus[novel.id] != null ? premiumStatus[novel.id] : '신청 가능'}"></button>
			                <br/>
						</div>
					</div>
					<hr/>
				</div>
			</div>
		</main>
		
		<th:block th:replace="~{/layout/fragments :: footer}"></th:block>
        <th:block th:replace="~{/layout/fragments :: bootstrapJS}"></th:block>
        <th:block th:replace="~{/layout/fragments :: axiosJS}"></th:block>
	</body>
</html>
